import{a as A,b as N,g as S,_ as D}from"./index.682428fc.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               */import{d as H,e as v,b2 as P,bc as O,aW as U,bi as $,C as j,aI as o,aG as s,aH as z,B as J,F as C,aM as m,aN as X,a$ as B,bh as G,be as W,bm as K,bj as Q,b9 as Y,ba as Z}from"./arco.572a1b40.js";import{f as ee,h as te}from"./vue.adf857d5.js";import"./chart.f83c6245.js";const oe=g=>(Y("data-v-f6ff2070"),g=g(),Z(),g),ue={class:"container"},ae=oe(()=>C("p",null,"\u57FA\u672C\u4FE1\u606F",-1)),se={style:{marginLeft:"40px"}},ne=H({__name:"edit",setup(g){const R=ee(),x=te(),L=n=>{R.push({name:n})},c=v({title:"\u8BF7\u8F93\u5165\u6807\u9898...",desc:"\u8BF7\u8F93\u5165\u63CF\u8FF0..."}),F=v("\u674E\u8001\u5E08"),_=v([]),f=v([]),w=v([]),y=v([]);(async function(){var n;try{const u={id:Number(x.params.id)},e=await N.post("/admin/course",u);c.value.title=e.data.title,c.value.desc=e.data.desc,F.value=(n=e.data.author)==null?void 0:n.at(0);const a=e.data.picture_url.split("."),d=e.data.vedio_url.split(".");w.value.push({uid:e.data.picture_id,name:a[a.length-1],url:e.data.picture_url}),y.value.push({uid:e.data.vedio_id,name:d[d.length-1],url:e.data.vedio_url}),_.value.push({uid:e.data.picture_id,url:e.data.picture_url}),f.value.push({uid:e.data.picture_id,url:e.data.picture_url});const i=1}catch(u){throw console.log(u),u}})();const q=n=>{const{onProgress:u,onError:e,onSuccess:a,fileItem:d,name:i}=n,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(l){let r;l.total>0&&(r=l.loaded/l.total),u(r,l)}),t.onerror=function(r){e(r)},t.onload=function(){if(t.status<200||t.status>=300)return e(t.responseText);const r=JSON.parse(t.responseText);return _.value.push({uid:r.data[0].id,url:r.data[0].url}),a(t.response)};const p=new FormData,b=String(S());return p.append(i||"file",d.file),t.open("post","/admin/upload_files",!0),t.setRequestHeader("Authorization",b),t.send(p),{abort(){t.abort()}}},V=n=>{const{uid:u}=n;for(let e=0;e<_.value.length;e+=1)Number(_.value[e].uid)===Number(u)&&_.value.splice(e,1);return new Promise((e,a)=>{B.confirm({title:"on-before-remove",content:`\u786E\u8BA4\u5220\u9664 ${n.name}`,onOk:()=>e(!0)})})},E=n=>{const{onProgress:u,onError:e,onSuccess:a,fileItem:d,name:i}=n,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(l){let r;l.total>0&&(r=l.loaded/l.total),u(r,l)}),t.onerror=function(r){e(r)},t.onload=function(){if(t.status<200||t.status>=300)return e(t.responseText);const r=JSON.parse(t.responseText);return f.value.push({uid:r.data[0].id,url:r.data[0].url}),a(t.response)};const p=new FormData,b=String(S());return p.append(i||"file",d.file),t.open("post","/admin/upload_files",!0),t.setRequestHeader("Authorization",b),t.send(p),{abort(){t.abort()}}},I=n=>{const{uid:u}=n;for(let e=0;e<f.value.length;e+=1)Number(f.value[e].uid)===Number(u)&&f.value.splice(e,1);return new Promise((e,a)=>{B.confirm({title:"on-before-remove",content:`\u786E\u8BA4\u5220\u9664 ${n.name}`,onOk:()=>e(!0)})})},M=A(),{login_id:le,user_id:k}=M,T=async function(){var n,u;try{const e={course_id:Number(x.params.id),title:c.value.title,desc:c.value.desc,author_id:Number(k),picture_id:Number((n=_.value[0])==null?void 0:n.uid),vedio_id:Number((u=f.value[0])==null?void 0:u.uid)},a=await N.post("/admin/course/update",e);debugger;L("SimuList")}catch(e){throw console.log(e),e}};return(n,u)=>{const e=z("Breadcrumb"),a=G,d=P,i=W,t=K,p=O,b=U,l=Q,r=$;return J(),j("div",ue,[o(e,{items:["menu.mSimu","menu.mSimu.edit"]},null,8,["items"]),o(r,null,{default:s(()=>[o(l,null,{default:s(()=>[ae,C("div",se,[o(i,null,{default:s(()=>[o(a,{span:2},{default:s(()=>[m("\u6807\u9898")]),_:1}),o(a,{span:2},{default:s(()=>[o(d,{modelValue:c.value.title,"onUpdate:modelValue":u[0]||(u[0]=h=>c.value.title=h),style:{width:"320px"},"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1}),o(i,null,{default:s(()=>[o(a,{span:2},{default:s(()=>[m("\u63CF\u8FF0")]),_:1}),o(a,{span:2},{default:s(()=>[o(d,{modelValue:c.value.desc,"onUpdate:modelValue":u[1]||(u[1]=h=>c.value.desc=h),style:{width:"800px"},"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1}),o(i,null,{default:s(()=>[o(a,{span:2},{default:s(()=>[m("\u4F5C\u8005")]),_:1}),o(a,{span:2,style:{paddingLeft:"20px"}},{default:s(()=>[o(t,null,{default:s(()=>[m(X(F.value),1)]),_:1})]),_:1})]),_:1}),o(i,null,{default:s(()=>[o(a,{span:2},{default:s(()=>[m("\u5C01\u9762\u56FE")]),_:1}),o(a,{span:4},{default:s(()=>[o(p,{"custom-request":q,limit:1,"file-list":w.value,onBeforeRemove:V},null,8,["file-list"])]),_:1})]),_:1}),o(i,null,{default:s(()=>[o(a,{span:2},{default:s(()=>[m("\u5C01\u9762\u89C6\u9891")]),_:1}),o(a,{span:4},{default:s(()=>[o(p,{"custom-request":E,limit:1,"file-list":y.value,onBeforeRemove:I},null,8,["file-list"])]),_:1})]),_:1})]),o(i,null,{default:s(()=>[o(a,{span:2,offset:22},{default:s(()=>[o(b,{type:"primary",onClick:u[2]||(u[2]=h=>T())},{default:s(()=>[m(" \u4FDD\u5B58 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}});const we=D(ne,[["__scopeId","data-v-f6ff2070"]]);export{we as default};
